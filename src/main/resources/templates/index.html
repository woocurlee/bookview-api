<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="~{layout :: head('BookView - ì±… ë¦¬ë·° í”Œë«í¼')}"></head>
<style>
    .review-quote {
        background: #f0f0f0;
        border-left: 4px solid #10b981;
        padding: 12px 16px;
        margin-bottom: 10px;
        font-style: italic;
        color: #555;
        border-radius: 4px;
    }
</style>
<body class="bg-gradient-to-br from-emerald-500 to-green-600 min-h-screen mb-10">
    <header th:replace="~{layout :: header}"></header>

    <div class="max-w-7xl mx-auto px-5">
        <!-- ë¦¬ë·° ì‘ì„± ìœ ë„ ë°•ìŠ¤ -->
        <div th:if="${user != null}"
             onclick="goToWriteReview()"
             class="bg-white rounded-2xl p-5 mb-8 shadow-lg flex gap-4 items-center cursor-pointer transition-all hover:-translate-y-1 hover:shadow-xl">
            <img src="/images/default-avatar.svg" alt="í”„ë¡œí•„" class="w-12 h-12 rounded-full object-cover">
            <div class="flex-1 py-3 px-5 bg-gray-100 rounded-full text-gray-400 text-base">ì˜¤ëŠ˜ ì½ì€ ì±…ì— ëŒ€í•œ ìƒê°ì„ ê³µìœ í•´ë³´ì„¸ìš”...</div>
        </div>

        <!-- ìµœê·¼ ë¦¬ë·° ì„¹ì…˜ -->
        <section th:if="${reviews != null && !reviews.isEmpty()}">
            <div id="reviewsContainer" th:each="review : ${reviews}">
                <div class="bg-gray-50 rounded-xl p-5 mb-5 transition-all hover:-translate-y-1 hover:shadow-lg flex gap-5">
                    <img th:src="${review.bookThumbnail}"
                         alt="ì±… í‘œì§€"
                         th:if="${review.bookThumbnail != null && !review.bookThumbnail.isEmpty()}"
                         class="h-48 object-cover rounded-lg flex-shrink-0">
                    <div class="flex-1">
                        <div class="text-xl font-bold mb-2 text-gray-800" th:text="${review.title}">ë¦¬ë·° ì œëª©</div>
                        <div class="text-sm text-gray-600 mb-2.5">
                            <span th:text="${review.bookTitle}">ì±… ì œëª©</span> -
                            <span th:text="${review.bookAuthor}">ì €ì</span>
                        </div>
                        <div class="text-yellow-400 mb-2.5">
                            <span th:each="i : ${#numbers.sequence(1, review.rating)}">â˜…</span>
                            <span th:if="${review.rating < 5}" th:each="i : ${#numbers.sequence(review.rating + 1, 5)}">â˜†</span>
                        </div>
                        <div class="review-quote" th:if="${review.quote != null && !review.quote.isEmpty()}">
                            "<span th:text="${review.quote}"></span>"
                        </div>
                        <div class="text-gray-700 leading-relaxed mb-2.5 overflow-hidden line-clamp-3" th:utext="${review.content}">ë¦¬ë·° ë‚´ìš©...</div>
                        <div class="text-xs text-gray-400"
                             th:text="${#temporals.format(review.createdAt, 'yyyy-MM-dd HH:mm')}">
                            2024-12-24 10:00
                        </div>
                    </div>
                </div>
            </div>
            <div id="loading" class="text-center p-5 hidden">
                <p>ë¡œë”© ì¤‘...</p>
            </div>
            <div id="endMessage" class="text-center p-5 hidden">
                <p>ëª¨ë“  ë¦¬ë·°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤. ğŸ‰</p>
            </div>
        </section>
    </div>

    <script>
        // hasMore ì´ˆê¸°ê°’ ì„¤ì •
        hasMore = /*[[${hasMoreReviews}]]*/ true;
    </script>
    <script src="/js/index.js"></script>
    <script th:replace="~{layout :: mobileMenuScript}"></script>
</body>
</html>
